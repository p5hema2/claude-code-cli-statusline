<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Claude Statusline Configuration</title>
  <link rel="stylesheet" href="styles/output.css">
  <link rel="stylesheet" href="styles/themes.css">
</head>
<body>
  <div id="app" class="flex flex-col min-h-screen max-w-[1200px] mx-auto px-6">
    <header class="header text-center py-8 pb-6 border-b border-border mb-6">
      <h1 class="m-0 text-lg font-semibold text-text-primary">Claude Statusline Configuration</h1>
      <p class="text-base text-text-secondary mt-2">Drag widgets to customize your statusline layout</p>
    </header>

    <main class="flex-1 flex flex-col gap-5">
      <!-- Terminal Preview -->
      <section class="bg-bg-secondary rounded border border-border p-4 px-5">
        <div class="flex justify-between items-center mb-3">
          <h2 class="m-0 text-md font-semibold">Preview</h2>
          <div class="preview-actions">
            <button id="reset-btn" class="btn btn-secondary">
              <span class="btn-icon">â†º</span>
              Reset to Defaults
            </button>
            <button id="save-btn" class="btn btn-primary">
              <span class="btn-icon">ðŸ’¾</span>
              Save Settings
            </button>
          </div>
        </div>
        <div id="terminal-preview" class="terminal-preview theme-dark">
          <div class="terminal-content">
            <div class="terminal-main">
              <div class="terminal-left" id="terminal-left">
                <div class="preview-row" id="preview-row-0">Loading...</div>
              </div>
              <div class="terminal-right" id="terminal-right">
                <!-- Claude Code context (file, selection) -->
              </div>
            </div>
            <div class="terminal-footer" id="terminal-footer">
              <!-- Plan mode indicator -->
            </div>
          </div>
        </div>

        <!-- Collapsible Claude Code Context and Terminal Options -->
        <details class="claude-context-details" id="claude-context-details" open>
          <summary class="claude-context-summary">
            <span class="summary-icon">â–¶</span>
            <span class="summary-text">Claude Code Context and Terminal Options</span>
          </summary>
          <div class="claude-context-details-content" id="claude-context-details-content">
            <!-- Terminal Configuration -->
            <div class="terminal-config">
              <h3 class="config-section-title">Terminal Configuration</h3>
              <p class="section-desc">Terminals interpret ANSI color codes differently. Select your terminal to see accurate colors.</p>
              <div class="preview-controls">
                <label class="control-label" for="terminal-select">
                  Terminal:
                  <select id="terminal-select" class="select">
                    <!-- Populated by JS from API -->
                  </select>
                </label>
                <label class="control-label" for="theme-select">
                  BG:
                  <select id="theme-select" class="select">
                    <option value="dark">VS Code Dark</option>
                    <option value="monokai">Monokai</option>
                    <option value="light">Light</option>
                    <option value="solarized-dark">Solarized Dark</option>
                    <option value="dracula">Dracula</option>
                    <option value="nord">Nord</option>
                  </select>
                </label>
                <label class="control-label" for="width-input">
                  Width:
                  <input type="number" id="width-input" value="156" min="40" max="200" class="input-number">
                  <span>cols</span>
                </label>
              </div>
            </div>

            <!-- Context Simulation -->
            <div class="context-simulation-section">
              <h3 class="config-section-title">Claude Code Context Simulation</h3>
              <p class="section-desc">Simulate Claude Code's UI elements shown alongside your statusline</p>
              <div class="context-toggles">
                <div class="radio-group">
                  <label class="radio-label" for="context-none">
                    <input type="radio" id="context-none" name="context-type" value="none">
                    <span>No context</span>
                  </label>
                  <label class="radio-label" for="context-file">
                    <input type="radio" id="context-file" name="context-type" value="file" checked>
                    <span>File context:</span>
                    <input type="text" id="file-context-name" value="statusline-settings.json" class="input-text" placeholder="filename" aria-label="File context filename">
                  </label>
                  <label class="radio-label" for="context-selection">
                    <input type="radio" id="context-selection" name="context-type" value="selection">
                    <span>Line selection:</span>
                    <input type="number" id="line-selection-count" value="13" min="1" max="999" class="input-number-sm" aria-label="Line selection count">
                    <span>lines</span>
                  </label>
                  <label class="radio-label" for="context-autocompact">
                    <input type="radio" id="context-autocompact" name="context-type" value="autocompact">
                    <span>Context left until auto-compact:</span>
                    <input type="number" id="autocompact-percent" value="5" min="1" max="20" class="input-number-sm" aria-label="Context left until auto-compact percentage">
                    <span>%</span>
                  </label>
                </div>
                <label class="checkbox-label" for="show-plan-mode">
                  <input type="checkbox" id="show-plan-mode" checked>
                  <span>Show plan mode indicator</span>
                </label>
              </div>
            </div>
          </div>
        </details>
      </section>

      <div class="editor-area grid grid-cols-[260px_1fr] gap-5">
        <!-- Widget Palette -->
        <section class="bg-bg-secondary rounded border border-border p-4 px-5 sticky top-5 self-start">
          <h2 class="m-0 mb-3 text-md font-semibold">Widgets</h2>
          <div id="widget-palette" class="widget-palette">
            <!-- Categories will be populated by JS -->
          </div>
        </section>

        <!-- Widget Config Panel (replaces Layout when open) -->
        <section id="widget-config-panel" class="config-section hidden col-start-2 row-start-1">
          <div class="flex justify-between items-center mb-4">
            <h2 id="config-widget-title" class="m-0 text-md font-semibold">Widget Settings</h2>
            <button id="config-close-btn" class="btn-icon" title="Close">Ã—</button>
          </div>
          <div id="config-content" class="config-content">
            <!-- Configuration options populated by JS -->
          </div>
        </section>

        <!-- Row Editor (hidden when config panel is open) -->
        <section class="rows-section bg-bg-secondary rounded border border-border p-4 px-5 col-start-2 row-start-1">
          <div class="flex justify-between items-center mb-3">
            <h2 class="m-0 text-md font-semibold">Layout</h2>
            <button id="add-row-btn" class="btn btn-secondary">+ Add Row</button>
          </div>
          <div id="row-editor" class="row-editor">
            <!-- Rows will be populated by JS -->
          </div>
        </section>
      </div>
    </main>

    <!-- Status message (positioned in upper right corner) -->
    <div id="status-message" class="status-message" role="status" aria-live="polite" aria-atomic="true"></div>

    <!-- Hidden live region for preview updates (screen readers only) -->
    <div id="preview-announcer" class="sr-only" role="status" aria-live="polite" aria-atomic="true"></div>
  </div>

  <!-- Live reload for development -->
  <script>
    (function() {
      const es = new EventSource('/__live-reload');
      es.onmessage = (e) => {
        if (e.data === 'reload') location.reload();
      };
      es.onerror = () => es.close();
    })();
  </script>
  <script type="module" src="main.js"></script>
</body>
</html>
